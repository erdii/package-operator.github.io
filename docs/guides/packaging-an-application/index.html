<!doctype html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel="preload" as="font" href="https://package-operator.run/fonts/vendor/jost/jost-v4-latin-regular.woff2" type="font/woff2" crossorigin><link rel="preload" as="font" href="https://package-operator.run/fonts/vendor/jost/jost-v4-latin-500.woff2" type="font/woff2" crossorigin><link rel="preload" as="font" href="https://package-operator.run/fonts/vendor/jost/jost-v4-latin-700.woff2" type="font/woff2" crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel="stylesheet" href="https://package-operator.run/main.bfcc962b7c49d7a514208fa0990904ad57e477c2041155b09b9c1c6f2a3f1106f8a89cc4ec3867b697c93ecd5e8924c440133dfef35e08bbe610d376ebf89830.css" integrity="sha512-v8yWK3xJ16UUII+gmQkErVfkd8IEEVWwm5wcbyo/EQb4qJzE7DhntpfJPs1eiSTEQBM9/vNeCLvmENN26/iYMA==" crossorigin="anonymous"><noscript><style>img.lazyload{display:none}</style></noscript><meta name="robots" content="index, follow"><meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Packaging an Application - Package Operator</title><meta name="description" content="Objectives # Create a manifest.yaml file Add annotations to Kubernetes object manifest files to specify phase Package all files in a Containerfile Build the image Before you begin # This guide assumes you have all the required software installed and have a Kubernetes cluster with Package Operator installed.
Application # The application is a simple nginx webserver deployment. The deployment should also be run in its own namespace, called nginx. The manifests for these two resources are as follows:"><link rel="canonical" href="https://package-operator.run/docs/guides/packaging-an-application/"><script type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://package-operator.run/#/schema/organization/1","name":"Doks","url":"https://package-operator.run/","sameAs":["https://twitter.com/getdoks","https://github.com/h-enk/doks"],"logo":{"@type":"ImageObject","@id":"https://package-operator.run/#/schema/image/1","url":"https://package-operator.run/logo-doks.png","width":512,"height":512,"caption":"Doks"},"image":{"@id":"https://package-operator.run/#/schema/image/1"}},{"@type":"WebSite","@id":"https://package-operator.run/#/schema/website/1","url":"https://package-operator.run/","name":"Package Operator","description":"Operator for packaging and managing a collection of arbitrary Kubernetes objects to install software on one or multiple clusters.","publisher":{"@id":"https://package-operator.run/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://package-operator.run/docs/guides/packaging-an-application/","url":"https://package-operator.run/docs/guides/packaging-an-application/","name":"Packaging an Application","description":"","isPartOf":{"@id":"https://package-operator.run/#/schema/website/1"},"about":{"@id":"https://package-operator.run/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://package-operator.run/docs/guides/packaging-an-application/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://package-operator.run/docs/guides/packaging-an-application/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://package-operator.run/docs/guides/packaging-an-application/"]}]},{"@type":"BreadcrumbList","@id":"https://package-operator.run/docs/guides/packaging-an-application/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://package-operator.run/","url":"https://package-operator.run/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://package-operator.run/docs/","url":"https://package-operator.run/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://package-operator.run/docs/guides/","url":"https://package-operator.run/docs/guides/","name":"Guides"}},{"@type":"ListItem","position":4,"item":{"@id":"https://package-operator.run/docs/guides/packaging-an-application/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://package-operator.run/#/schema/article/1","headline":"Packaging an Application","description":"","isPartOf":{"@id":"https://package-operator.run/docs/guides/packaging-an-application/"},"mainEntityOfPage":{"@id":"https://package-operator.run/docs/guides/packaging-an-application/"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","author":{"@id":"https://package-operator.run/#/schema/person/2"},"publisher":{"@id":"https://package-operator.run/#/schema/organization/1"},"image":{"@id":"https://package-operator.run/docs/guides/packaging-an-application/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://package-operator.run/#/schema/person/2","name":"Henk Verlinde","sameAs":["https://twitter.com/henkverlinde","https://www.linkedin.com/in/henkverlinde/","https://github.com/h-enk"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://package-operator.run/docs/guides/packaging-an-application/#/schema/image/2","url":null,"contentUrl":null,"caption":"Packaging an Application"}]}]}</script><meta name="theme-color" content="#fff"><link rel="icon" href="https://package-operator.run/favicon.ico" sizes="any"><link rel="icon" type="image/svg+xml" href="https://package-operator.run/%20favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="https://package-operator.run/%20apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://package-operator.run/%20favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://package-operator.run/%20favicon-16x16.png"><meta name="go-import" content="package-operator.run/package-operator git https://github.com/package-operator/package-operator.git"><meta name="go-import" content="package-operator.run git https://github.com/package-operator/package-operator.git"></head><body class="docs single"><div class="sticky-top"><div class="header-bar"></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href="/" aria-label="Package Operator">Package Operator</a>
<button class="btn btn-link order-0 ms-auto d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample" aria-controls="offcanvasExample"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel"><div class="header-bar"></div><div class="offcanvas-header"><h5 class="offcanvas-title" id="offcanvasExampleLabel">Browse docs</h5><button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button></div><div class="offcanvas-body"><aside class="doks-sidebar mt-n3"><nav id="doks-docs-nav" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Getting Started</h3><ul class="list-unstyled"><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/introduction/">Introduction</a></li><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/architecture/">Architecture</a></li><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/requirements/">Requirements</a></li><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/installation/">Installation</a></li><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/api-reference/">API Reference</a></li></ul><h3 class="h6 text-uppercase mb-2">Guides</h3><ul class="list-unstyled"><li><a class="docs-link active" href="https://package-operator.run/docs/guides/packaging-an-application/">Packaging an Application</a></li><li><a class="docs-link" href="https://package-operator.run/docs/guides/installing-packages/">Installing Packages</a></li><li><a class="docs-link" href="https://package-operator.run/docs/guides/packaging-an-operator/">Packaging an Operator</a></li></ul><h3 class="h6 text-uppercase mb-2">Concepts</h3><ul class="list-unstyled"><li><a class="docs-link" href="https://package-operator.run/docs/concepts/reconciliation/">Object Reconciliation</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/probes/">Probes</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/phases/">Phases</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/scopes/">Scopes</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/revisions/">Revisions</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/package-format/">Package Format</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/big-packages/">Big Packages</a></li></ul><h3 class="h6 text-uppercase mb-2">Docs Help</h3><ul class="list-unstyled"><li><a class="docs-link" href="https://package-operator.run/docs/docs_help/how-to-update/">How to Update</a></li><li><a class="docs-link" href="https://package-operator.run/docs/docs_help/troubleshooting/">Troubleshooting</a></li><li><a class="docs-link" href="https://package-operator.run/docs/docs_help/faq/">FAQ</a></li></ul></nav></aside></div></div><button class="btn btn-menu order-2 d-block d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasDoks" aria-controls="offcanvasDoks" aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex="-1" id="offcanvasDoks" data-bs-backdrop="true" aria-labelledby="offcanvasDoksLabel"><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id="offcanvasDoksLabel"><a class="text-dark" href="/">Package Operator</a></h2><button type="button" class="btn-close text-reset me-2" data-bs-dismiss="offcanvas" aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class="nav-item"><a class="nav-link ps-0 py-1 active" href="/docs/getting_started/introduction">Docs</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href="#" id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">Get Started
<span class="dropdown-caret"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby="navbarDropdownMenuLink"><li><a class="dropdown-item" href="/docs/getting_started/installation">Installation</a></li><li><a class="dropdown-item" href="/docs/guides">Guides</a></li></ul></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id="search" class="form-control is-search" type="search" placeholder="Search docs..." aria-label="Search docs..." autocomplete="off"><div id="suggestions" class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class="nav-item"><a class="nav-link social-link" href="https://github.com/package-operator/package-operator"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id="mode" class="btn btn-link" type="button" aria-label="Toggle user interface mode">
<span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class="container-xxl"><aside class="doks-sidebar"><nav id="doks-docs-nav" class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Getting Started</h3><ul class="list-unstyled"><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/introduction/">Introduction</a></li><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/architecture/">Architecture</a></li><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/requirements/">Requirements</a></li><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/installation/">Installation</a></li><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/api-reference/">API Reference</a></li></ul><h3 class="h6 text-uppercase mb-2">Guides</h3><ul class="list-unstyled"><li><a class="docs-link active" href="https://package-operator.run/docs/guides/packaging-an-application/">Packaging an Application</a></li><li><a class="docs-link" href="https://package-operator.run/docs/guides/installing-packages/">Installing Packages</a></li><li><a class="docs-link" href="https://package-operator.run/docs/guides/packaging-an-operator/">Packaging an Operator</a></li></ul><h3 class="h6 text-uppercase mb-2">Concepts</h3><ul class="list-unstyled"><li><a class="docs-link" href="https://package-operator.run/docs/concepts/reconciliation/">Object Reconciliation</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/probes/">Probes</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/phases/">Phases</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/scopes/">Scopes</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/revisions/">Revisions</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/package-format/">Package Format</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/big-packages/">Big Packages</a></li></ul><h3 class="h6 text-uppercase mb-2">Docs Help</h3><ul class="list-unstyled"><li><a class="docs-link" href="https://package-operator.run/docs/docs_help/how-to-update/">How to Update</a></li><li><a class="docs-link" href="https://package-operator.run/docs/docs_help/troubleshooting/">Troubleshooting</a></li><li><a class="docs-link" href="https://package-operator.run/docs/docs_help/faq/">FAQ</a></li></ul></nav></aside></div><div class="wrap container-xxl" role="document"><div class="content"><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav id="sidebar-default" class="docs-links" aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2">Getting Started</h3><ul class="list-unstyled"><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/introduction/">Introduction</a></li><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/architecture/">Architecture</a></li><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/requirements/">Requirements</a></li><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/installation/">Installation</a></li><li><a class="docs-link" href="https://package-operator.run/docs/getting_started/api-reference/">API Reference</a></li></ul><h3 class="h6 text-uppercase mb-2">Guides</h3><ul class="list-unstyled"><li><a class="docs-link active" href="https://package-operator.run/docs/guides/packaging-an-application/">Packaging an Application</a></li><li><a class="docs-link" href="https://package-operator.run/docs/guides/installing-packages/">Installing Packages</a></li><li><a class="docs-link" href="https://package-operator.run/docs/guides/packaging-an-operator/">Packaging an Operator</a></li></ul><h3 class="h6 text-uppercase mb-2">Concepts</h3><ul class="list-unstyled"><li><a class="docs-link" href="https://package-operator.run/docs/concepts/reconciliation/">Object Reconciliation</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/probes/">Probes</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/phases/">Phases</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/scopes/">Scopes</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/revisions/">Revisions</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/package-format/">Package Format</a></li><li><a class="docs-link" href="https://package-operator.run/docs/concepts/big-packages/">Big Packages</a></li></ul><h3 class="h6 text-uppercase mb-2">Docs Help</h3><ul class="list-unstyled"><li><a class="docs-link" href="https://package-operator.run/docs/docs_help/how-to-update/">How to Update</a></li><li><a class="docs-link" href="https://package-operator.run/docs/docs_help/troubleshooting/">Troubleshooting</a></li><li><a class="docs-link" href="https://package-operator.run/docs/docs_help/faq/">FAQ</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class="d-xl-none"><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#onThisPage" aria-controls="doks-docs-nav" aria-expanded="false" aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class="collapse" id="onThisPage"><div class="card card-body mt-3 py-1"><div class="page-links"><nav id="TableOfContents"><ul><li><a href="#objectives">Objectives</a></li><li><a href="#before-you-begin">Before you begin</a></li><li><a href="#application">Application</a><ul><li></li></ul></li><li><a href="#package-manifest">Package Manifest</a><ul><li></li><li><a href="#scopes">Scopes</a></li><li><a href="#phases">Phases</a></li><li><a href="#availability-probes">Availability Probes</a></li></ul></li><li><a href="#annotations">Annotations</a><ul><li></li></ul></li><li><a href="#package-image">Package Image</a><ul><li></li></ul></li><li><a href="#next-steps">Next Steps</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id="TableOfContents"><ul><li><a href="#objectives">Objectives</a></li><li><a href="#before-you-begin">Before you begin</a></li><li><a href="#application">Application</a><ul><li></li></ul></li><li><a href="#package-manifest">Package Manifest</a><ul><li></li><li><a href="#scopes">Scopes</a></li><li><a href="#phases">Phases</a></li><li><a href="#availability-probes">Availability Probes</a></li></ul></li><li><a href="#annotations">Annotations</a><ul><li></li></ul></li><li><a href="#package-image">Package Image</a><ul><li></li></ul></li><li><a href="#next-steps">Next Steps</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>Packaging an Application</h1><p class="lead"></p><nav class="d-xl-none" aria-label="Quaternary navigation"><div class="d-xl-none"><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#onThisPage" aria-controls="doks-docs-nav" aria-expanded="false" aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class="collapse" id="onThisPage"><div class="card card-body mt-3 py-1"><div class="page-links"><nav id="TableOfContents"><ul><li><a href="#objectives">Objectives</a></li><li><a href="#before-you-begin">Before you begin</a></li><li><a href="#application">Application</a><ul><li></li></ul></li><li><a href="#package-manifest">Package Manifest</a><ul><li></li><li><a href="#scopes">Scopes</a></li><li><a href="#phases">Phases</a></li><li><a href="#availability-probes">Availability Probes</a></li></ul></li><li><a href="#annotations">Annotations</a><ul><li></li></ul></li><li><a href="#package-image">Package Image</a><ul><li></li></ul></li><li><a href="#next-steps">Next Steps</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id="TableOfContents"><ul><li><a href="#objectives">Objectives</a></li><li><a href="#before-you-begin">Before you begin</a></li><li><a href="#application">Application</a><ul><li></li></ul></li><li><a href="#package-manifest">Package Manifest</a><ul><li></li><li><a href="#scopes">Scopes</a></li><li><a href="#phases">Phases</a></li><li><a href="#availability-probes">Availability Probes</a></li></ul></li><li><a href="#annotations">Annotations</a><ul><li></li></ul></li><li><a href="#package-image">Package Image</a><ul><li></li></ul></li><li><a href="#next-steps">Next Steps</a></li></ul></nav></div></nav><h2 id="objectives">Objectives <a href="#objectives" class="anchor" aria-hidden="true">#</a></h2><ul><li>Create a manifest.yaml file</li><li>Add annotations to Kubernetes object manifest files to specify phase</li><li>Package all files in a Containerfile</li><li>Build the image</li></ul><h2 id="before-you-begin">Before you begin <a href="#before-you-begin" class="anchor" aria-hidden="true">#</a></h2><p>This guide assumes you have all the <a href="/docs/getting_started/requirements">required software</a> installed and have a
Kubernetes cluster with <a href="/docs/getting_started/installation">Package Operator installed</a>.</p><h2 id="application">Application <a href="#application" class="anchor" aria-hidden="true">#</a></h2><p>The application is a simple nginx webserver deployment. The deployment should also be run in
its own namespace, called nginx. The manifests for these two resources are as follows:</p><h6 id="namespaceyaml">namespace.yaml <a href="#namespaceyaml" class="anchor" aria-hidden="true">#</a></h6><pre><code class="language-yaml">apiVersion: v1
kind: Namespace
metadata:
  name: nginx
</code></pre><h6 id="deploymentyaml">deployment.yaml <a href="#deploymentyaml" class="anchor" aria-hidden="true">#</a></h6><pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  namespace: nginx
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - name: nginx
          image: nginx:latest
          ports:
            - containerPort: 80
</code></pre><h2 id="package-manifest">Package Manifest <a href="#package-manifest" class="anchor" aria-hidden="true">#</a></h2><p>The first step in packaging an application is to create a package manifest file. Read more about the package
manifest file on the <a href="/docs/concepts/package-format">Package Format page</a>.
For our application the package manifest file looks like:</p><h6 id="manifestyaml">manifest.yaml <a href="#manifestyaml" class="anchor" aria-hidden="true">#</a></h6><pre><code class="language-yaml">apiVersion: manifests.package-operator.run/v1alpha1
kind: PackageManifest
metadata:
  name: nginx
spec:
  scopes:
  - Cluster
  phases:
  - name: namespace
  - name: deploy
  availabilityProbes:
  - probes:
    - condition:
        type: Available
        status: &quot;True&quot;
    - fieldsEqual:
        fieldA: .status.updatedReplicas
        fieldB: .status.replicas
    selector:
      kind:
        group: apps
        kind: Deployment
</code></pre><p>A short discussion about the different fields in <code>.spec</code>.</p><h3 id="scopes">Scopes <a href="#scopes" class="anchor" aria-hidden="true">#</a></h3><p>Since the package contains a namespace object, which is cluster scoped, the only possible scope for the
package is <code>Cluster</code>. You can read more about scopes on the <a href="/docs/concepts/scopes">Scopes page</a>.</p><h3 id="phases">Phases <a href="#phases" class="anchor" aria-hidden="true">#</a></h3><p>The namespace must be created before the deployment. Therefore, the Package Manifest file has two phases defined,
<code>namespace</code> and <code>deploy</code>, in that order. Read more about phases
on the <a href="/docs/concepts/phases">Phases page</a>.</p><h3 id="availability-probes">Availability Probes <a href="#availability-probes" class="anchor" aria-hidden="true">#</a></h3><p>This is a standard probe for deployment resources. You can read more about availability probes
on the <a href="/docs/concepts/probes">Probes page</a>.</p><h2 id="annotations">Annotations <a href="#annotations" class="anchor" aria-hidden="true">#</a></h2><p>Now we have to link each object to a phase. This is done by adding a <code>package-operator.run/phase</code> annotation to the object.
For example, our <code>namespace.yaml</code> file would now look like:</p><h6 id="namespaceyaml-1">namespace.yaml <a href="#namespaceyaml-1" class="anchor" aria-hidden="true">#</a></h6><pre><code class="language-yaml">apiVersion: v1
kind: Namespace
metadata:
  name: nginx
  annotations:
    package-operator.run/phase: namespace
</code></pre><h2 id="package-image">Package Image <a href="#package-image" class="anchor" aria-hidden="true">#</a></h2><p>Package Operator receives these files via a non-runnable container image. The files have to be contained in the
<code>/package</code> directory in the image. Therefore, the container file is very simple:</p><h6 id="packagecontainerfile">package.Containerfile <a href="#packagecontainerfile" class="anchor" aria-hidden="true">#</a></h6><pre><code class="language-dockerfile">FROM scratch

ADD . /package
</code></pre><h4 id="build-the-image">Build the Image <a href="#build-the-image" class="anchor" aria-hidden="true">#</a></h4><p>This package image can be built with whichever tool you use for building images, for example:</p><pre><code class="language-shell">podman build -t packageImage -f package.Containerfile .
</code></pre><h2 id="next-steps">Next Steps <a href="#next-steps" class="anchor" aria-hidden="true">#</a></h2><p>See the <a href="/docs/guides/installing-packages">Installing Packages page</a> to see how to deploy packages using Package Operator.</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="docs-navigation d-flex justify-content-between"><a class="ms-auto" href="/docs/guides/installing-packages/"><div class="card my-1"><div class="card-body py-2">Installing Packages &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class="container-xxl"><div class="row"><div class="col-lg-8 order-last order-lg-first"><ul class="list-inline"><li class="list-inline-item">Powered by <a class="text-muted" href="https://gohugo.io/">Hugo</a> and <a class="text-muted" href="https://getdoks.org/">Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class="list-inline"></ul></div></div></div></footer><script src="/js/bootstrap.min.650aeec64c81d69d4c0850fc73c93da3f0330cec0a27772feed7f90f60baa5f47f1c45687d71914bdafd1c4e860d40f6dc08ede27a2f08431ff929c9a2d24621.js" integrity="sha512-ZQruxkyB1p1MCFD8c8k9o/AzDOwKJ3cv7tf5D2C6pfR/HEVofXGRS9r9HE6GDUD23Ajt4novCEMf+SnJotJGIQ==" crossorigin="anonymous" defer></script>
<script src="/js/highlight.min.3f0a703c54cbed82ca277187e23cf2d272da28c15ce7e33cde685d40b53d741893d5b74d35bb2d20a81f56c289084f245bdd0c9145d39d7094d3dfbc62d1326a.js" integrity="sha512-PwpwPFTL7YLKJ3GH4jzy0nLaKMFc5+M83mhdQLU9dBiT1bdNNbstIKgfVsKJCE8kW90MkUXTnXCU09+8YtEyag==" crossorigin="anonymous" defer></script>
<script src="/main.min.cb2e2ebbf2e4002f3117addc33582923b2b3ae5265c22944cd117ebec7abe61c170417c4506d7a0f8f0fc9053dfdf441421d53601ac467042ff3d06ec0ba07fa.js" integrity="sha512-yy4uu/LkAC8xF63cM1gpI7KzrlJlwilEzRF+vser5hwXBBfEUG16D48PyQU9/fRBQh1TYBrEZwQv89BuwLoH+g==" crossorigin="anonymous" defer></script>
<script src="https://package-operator.run/index.min.f3205cd6c9b7403ad6e9305baca072bcc68c9a3ccb6b7d223fcc339aa41498ff5e330f843103edb15b529cdfac2012265e02d5e9ba8b4871deabedb7c9d29487.js" integrity="sha512-8yBc1sm3QDrW6TBbrKByvMaMmjzLa30iP8wzmqQUmP9eMw+EMQPtsVtSnN+sIBImXgLV6bqLSHHeq+23ydKUhw==" crossorigin="anonymous" defer></script></body></html>